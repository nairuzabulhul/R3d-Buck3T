<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Domain Enumeration with PowerShell Active Directory Module</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
}

.simple-table-header {
	background: rgb(247, 246, 243);
	color: black;
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="a6d901bd-09ce-46f9-a4be-4bcb85b9d6df" class="page sans"><header> style="object-position:center 65.35%"/><div class="page-header-icon page-header-icon-with-cover"><span class="icon">üñäÔ∏è</span></div><h1 class="page-title">Domain Enumeration with PowerShell Active Directory Module</h1></header><div class="page-body"><nav id="ff366e04-696c-41da-8356-e7783cf59704" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#51abbe86-a1c5-4ebc-bff6-ccbbe3c16578">üõ†Ô∏è$_Perquisites</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#94eaef59-6f81-4912-8a6b-06f69e9d0ad4">Import Modules </a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#af97c5b0-f176-44c6-b523-59ab52739c96"><span style="border-bottom:0.05em solid">Domain Enumeration</span></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#6dd0b013-d426-4ee1-97e6-b2ebf9b5da90"><span style="border-bottom:0.05em solid"><strong>Domain Controller Information</strong></span></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#096130c0-ba21-49f9-ab8c-4627add696be"><span style="border-bottom:0.05em solid"><strong>User Enumeration</strong></span></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#3180d45a-e1d1-44be-abd7-6d275ad06179"><span style="border-bottom:0.05em solid">Properties Enumeration</span></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#3eece333-e43e-4506-82b3-ae58cffd8ae6"><span style="border-bottom:0.05em solid"><strong>Computer Enumeration</strong></span></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#0dfaf43b-ea30-47e5-90a1-912a10fc27b5"><span style="border-bottom:0.05em solid">Group Enumeration</span></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#4ad72a23-3303-4f67-8247-1a316b424fd5"><span style="border-bottom:0.05em solid"><strong>Group Members</strong></span></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#c7bed137-dfc7-4cd4-bfd8-427eb03a9361">Enumerating Organizational Units [OU]</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#9b3d589d-288b-4983-83b2-47db6e5643fd">üîî Follow R3d Buck3t Publication on Medium - <a href="https://medium.com/r3d-buck3t">https://medium.com/r3d-buck3t</a></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#9e2826ca-4509-4db1-8847-ad547422c420">üìö$_Resources</a></div></nav><p id="c5d49eb7-927d-4eae-9117-024dc4336ff5" class="">
</p><h1 id="51abbe86-a1c5-4ebc-bff6-ccbbe3c16578" class="block-color-red">üõ†Ô∏è$_Perquisites</h1><ul id="9c02e712-bebc-448d-ae9d-0705a00451af" class="bulleted-list"><li style="list-style-type:disc">Microsoft Active Directory Management DLL</li></ul><ul id="07df0b57-8f9f-47b9-882b-baffe7e31d5a" class="bulleted-list"><li style="list-style-type:disc">PowerShell Active Directory module <a href="https://github.com/samratashok/ADModule/blob/master/ActiveDirectory/ActiveDirectory.psd1"><em><strong>ActiveDirectory.psd1</strong></em></a></li></ul><ul id="f3394584-ddf3-4e2c-9fa1-0bbcf1679acb" class="bulleted-list"><li style="list-style-type:disc"><a href="https://github.com/samratashok/ADModule/blob/master/ActiveDirectory/ActiveDirectory.Format.ps1xml"><em><strong>ActiveDirectory.Format.ps1xm</strong></em></a><a href="https://github.com/samratashok/ADModule/blob/master/ActiveDirectory/ActiveDirectory.Format.ps1xml">l</a> file from</li></ul><p id="e555ce7a-ec6a-454f-8a5d-5aafa4f35ba2" class=""><strong>üìç</strong><em><strong> No Admin Privileges needed to import the DLL or use it</strong></em></p><p id="cb297ff3-18ca-4c9b-b779-39e89b8ed3d4" class="">
</p><p id="7d6514cf-d0a5-46ac-a575-588f2c1d8c23" class="">üîî<code><strong>Domain enumeration can be done with unprivileged user </strong></code></p><h1 id="94eaef59-6f81-4912-8a6b-06f69e9d0ad4" class="block-color-purple">Import Modules </h1><p id="cf02bf3f-6a33-44d3-ae5c-07cee5788abf" class=""><code><strong>Import Microsoft Active Directory Management DLL</strong></code></p><blockquote id="ca55d2f7-f09e-4395-a191-247fc7d43b27" class=""><strong>Import-Module C:\Active-Directory-Module\Microsoft.ActiveDirectory.Management.dll</strong></blockquote><p id="01fa7968-e268-41ac-88be-1184a61f88d1" class=""><code><strong>Import PowerShell Active Directory module </strong></code><code><strong><a href="https://github.com/samratashok/ADModule/blob/master/ActiveDirectory/ActiveDirectory.psd1"><em>ActiveDirectory.psd1</em></a></strong></code></p><blockquote id="e85245a3-374a-4789-92ae-ea001dc118fc" class=""><strong>Import-Module  C:\Active-Directory-Module\ActiveDirectory\ActiveDirectory.psd1</strong></blockquote><h1 id="af97c5b0-f176-44c6-b523-59ab52739c96" class="block-color-purple"><span style="border-bottom:0.05em solid">Domain Enumeration</span></h1><p id="8831cb40-804d-42ca-93a0-5211eefc5e43" class=""><code><strong>Get Current Domain</strong></code></p><blockquote id="0215276b-999b-4c21-93ce-66deaccc9a8c" class=""><strong>Get-ADDomain</strong></blockquote><p id="b67f776d-cb93-45af-b78e-e67a6ff5e27f" class="block-color-red"><strong><code>Get object of another domain</code></strong></p><ul id="b5f9aef0-594c-43b9-b106-9ca3f62b3941" class="bulleted-list"><li style="list-style-type:disc">We can extract information with the <strong>Get-ADDomain</strong> command from another trusted domain that we have privileges on</li></ul><blockquote id="4ddcca63-3b1e-4fc3-905b-51270f5c9266" class=""><strong>Get-ADDomain -Identity [DOMAIN NAME]</strong></blockquote><blockquote id="eca0c622-b705-44db-9d81-fcd0422891a2" class=""><strong>Get-ADDomain -Identity moneycorp.local</strong></blockquote><p id="7a90d832-bdc5-49a2-8173-83bfa772efe6" class="block-color-red"><strong><code>Get domain SID for the current domain</code></strong></p><blockquote id="e032c20f-b22a-446c-ac6d-9f45a367ea50" class=""><strong>(Get-ADDomain).DomainSID</strong></blockquote><p id="07be07f7-a9c4-4bdc-aa4e-8524a34c7ee2" class="">
</p><h3 id="6dd0b013-d426-4ee1-97e6-b2ebf9b5da90" class="block-color-red"><span style="border-bottom:0.05em solid"><strong>Domain Controller Information</strong></span></h3><p id="578858a9-1900-4c62-ba7e-65b7caa10db6" class=""><code><strong>The command shows information about the domain controller</strong></code></p><blockquote id="2efc1f15-45e3-4f31-89c4-27b806e41ddf" class=""><strong>Get-ADDomainController</strong></blockquote><p id="9761caf0-95ed-41f4-9cef-ec786c2baef0" class="block-color-red"><strong><code>Get domain controllers for another domain</code></strong></p><blockquote id="3954faa4-3b17-49ad-98fc-997235bcd6ca" class=""><strong>Get-ADDomainController -DomainName megabank.local -Discover</strong></blockquote><p id="a63295c0-eafc-4fae-86d0-4fbd27bdef01" class="">
</p><h3 id="096130c0-ba21-49f9-ab8c-4627add696be" class="block-color-red"><span style="border-bottom:0.05em solid"><strong>User Enumeration</strong></span></h3><p id="0b6995fe-cfd4-40b7-b0c9-9c2f2b8ee909" class=""><code><strong>Filter with a wildcard (*) is used to return all users from the DC</strong></code></p><blockquote id="d79d4aec-3aad-4be4-ad1f-78c98a8bdb18" class=""><strong>Get-ADUser -Filter *</strong></blockquote><p id="a4f70728-e7b1-4c10-94a9-bca692a7fece" class=""><code><strong>The command shows the properties of all users. It is always recommended to specify the identity parameter to limit the returned results</strong></code></p><blockquote id="da6d34b8-4af5-4682-908b-bd5597356640" class=""><strong>Get-ADUser -Filter*  -Properties *</strong></blockquote><blockquote id="37c7a974-e519-4d45-ad34-b789274e91be" class=""><strong>Get-AdUser -Filter * -Properties * | Select Name</strong></blockquote><blockquote id="b31e50a9-c0d8-435d-8695-e36af5eae749" class=""><strong>Get-ADUser -Identity UserName  -Properties *</strong></blockquote><p id="a8223c28-6d88-4633-ba66-7c44e4ffa9b1" class=""><strong><code>The command returns sam accounts</code></strong></p><blockquote id="be3d02e5-80c2-480d-a108-9216d7c3f126" class=""><strong>Get-ADUser -Filter * -Properties *| Select Name, SamAccountName, Description</strong></blockquote><p id="a06ef5cf-40bd-4fff-bb39-41f364822ead" class=""><strong><code>The command filters for all users and returns enabled ones </code></strong></p><blockquote id="c7a4459e-eb0a-4482-ad25-99b642711ea9" class=""><strong>Get-ADUser -Filter * | ?{ $_.Enabled -eq &quot;true&quot; }</strong></blockquote><p id="2f8a9023-b14a-4bf3-a8d9-b5809c6d6a87" class=""><strong><code>The command searches for the description properties for built account. The search Term is built</code></strong></p><blockquote id="2847cb18-8405-4b26-bc04-b69c02add9ce" class=""><strong>Get-ADUser -Filter &#x27;Description -like &quot;</strong><strong><em>built</em></strong><strong>&quot;&#x27; -properties description | select name, description</strong></blockquote><ul id="3c618a45-d5c0-4988-a6bb-800284e59910" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><code><strong>Sometimes the description property contain sensitive information like passwords</strong></code></mark></li></ul><p id="df3e3ff3-1d8f-40a8-b24f-39a8e9b9cecb" class=""><code><strong>The command returns all users with their  name and logout counts</strong></code></p><blockquote id="1bfc19db-670e-4e36-ab72-005fd671a496" class=""><strong>Get-AdUser -Filter * -Properties * | Select Name, logonCount</strong></blockquote><ul id="8c4f8c4b-c0c3-4de4-ae09-106dcf7011fb" class="bulleted-list"><li style="list-style-type:disc"><strong><code><mark class="highlight-blue">Always choose the user that has a reasonable logon count to create a Golden Ticket</mark></code></strong></li></ul><ul id="4e9bafb4-0ef6-421c-8030-5b3fb314cf49" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><strong><code>Decoy users either have very high </code></strong></mark><mark class="highlight-blue"><strong><code><em>logoncount</em></code></strong></mark><mark class="highlight-blue"><strong><code> or very low</code></strong></mark></li></ul><p id="cd8bbbaa-8954-4de7-b3ea-b9ad48bc10fd" class="">
</p><h3 id="3180d45a-e1d1-44be-abd7-6d275ad06179" class="block-color-red"><span style="border-bottom:0.05em solid">Properties Enumeration</span></h3><p id="002fb9d4-aa35-49ef-a033-a54f6c46f920" class=""><code><strong>The command searches for all users and returns all of the users and the last time their password were reset</strong></code></p><blockquote id="d473a949-7c73-4a4d-bd06-3914b448a4f0" class=""><strong>Get-ADUser -Filter * -Properties * | Select -First 1 | Get-Member -MemberType *Property | select Name</strong></blockquote><blockquote id="fe421c08-73bd-4732-a249-9c672b79812e" class=""><strong>Get-ADUser -Filter * -Properties * | Select Name,@{expression={[datetime]::fromFileTime($_.pwdlastset)}}</strong></blockquote><ul id="9d93183f-a8d9-4d80-b536-5aeb362fb90f" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><strong>In an assessment, passwords that were not reset for a long time could be a decoy, honey account. Try avoiding them during the post-exploitation phase.</strong></mark></li></ul><p id="42f02e37-90c9-44c3-a919-7818683b1a68" class=""><strong><code><mark class="highlight-blue">The badpwdcount property can show active users from the non-active or decoy accounts. The higher the number of bad password counts, the chances that the account is real, and the lower is a decoy or not active.</mark></code></strong></p><blockquote id="cfc1a6af-e40e-4bcb-a1e2-ca165370ca93" class=""><strong>Get-ADUser -Filter * -Properties * | select Name,badpwdcount</strong></blockquote><p id="eccb0fa1-abee-4771-8b60-d96ea1bb1d77" class="">
</p><h3 id="3eece333-e43e-4506-82b3-ae58cffd8ae6" class="block-color-red"><span style="border-bottom:0.05em solid"><strong>Computer Enumeration</strong></span></h3><blockquote id="5365d89e-62c8-4594-aef5-05eaa7768d93" class=""><strong>Get-ComputerInfo</strong></blockquote><p id="331ac57e-ec7c-459d-b38a-22e7db1c9e38" class=""><strong><code><em>*gets information about the authenticated computer objects</em></code></strong></p><blockquote id="c63f6a55-3ce8-40e5-81ed-ca3d88d36548" class=""><strong>Get-AdComputer -Filter *</strong></blockquote><ul id="6e6c7fa9-8b03-4585-9ff4-2675ff8b6a67" class="bulleted-list"><li style="list-style-type:disc"><strong><mark class="highlight-blue"><code>Not all returned computer objects are actual active computers - keep this in mind when pivoting</code></mark></strong></li></ul><ul id="e1cfd781-2cb4-470b-9c7f-6b46945e7e7c" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><code><strong>To check for computers that are active, filter the results for lastLogonDate and Lastlogon properties to see which their the computer activity</strong></code></mark></li></ul><p id="fe0bf2d1-e7ea-40d2-9f9c-11441600dda7" class=""><code><strong>The command returns all computers names</strong></code></p><blockquote id="bae32d87-9d18-4c01-97f1-ff6251ea5a31" class=""><strong>Get-AdComputer -Filter * | select Name</strong></blockquote><p id="73425813-63fb-456c-87a7-d5121ba81cd5" class=""><code><strong>The command returns all computer names, last logon time and their IP address</strong></code> </p><blockquote id="9b5df83c-ede0-4c7b-9024-be5358e9e035" class=""><strong>Get-AdComputer -Filter * -Properties * | select Name, LastLogonDate, lastLogon, IPv4Address</strong></blockquote><p id="a154b2d5-7dfc-4192-a378-ad07f88d842f" class=""><code><strong>The command checks for all computers and filters down the machines that have Windows 2016 systems</strong></code></p><blockquote id="bca7d9fd-cc4e-4798-b907-b81b27b12aff" class=""><strong>Get-ADComputer -Filter &#x27;OperatingSystem -like &quot;*Server 2016*&quot;&#x27; -Properties OperatingSystem | select Name, OperatingSystem</strong></blockquote><p id="b8ebbcf4-379c-4286-8207-5051aaacda8a" class=""><code><strong>The command do a dnslooup for all of the machine of the domain and return the active ones similar to ping command but with dns</strong></code></p><blockquote id="d97c2429-c225-4a50-a5c5-e71b118219f0" class=""><strong>Get-ADComputer -Filter * -Properties DNSHostName | %{Test-Connection -Count 1 -ComputerName $_.DNSHostName }</strong></blockquote><blockquote id="4e879d3d-f69f-4eca-b96b-cb8bb57164e1" class=""><strong>GetADComputer -Filter * -Properties * </strong></blockquote><p id="8496239b-a99b-4ba5-9de4-425594ee293e" class="">
</p><h3 id="0dfaf43b-ea30-47e5-90a1-912a10fc27b5" class="block-color-red"><span style="border-bottom:0.05em solid">Group Enumeration</span></h3><blockquote id="d5e7bede-da89-4af2-83e9-76e202744f8d" class=""><strong>Get-ADGroup -Filter * | select name</strong></blockquote><blockquote id="047c5a12-0591-451a-96cb-b9706a483fac" class=""><strong>Get-ADGroup -Filter *  -Properties *</strong></blockquote><p id="bbc935c1-1d44-45ff-bd4b-0ceacd6b64b0" class=""><code><strong>The command returns groups containing admin </strong></code></p><blockquote id="ad9b19cd-3f5e-4024-800a-cbf6edeec7f1" class=""><strong>Get-ADGroup -Filter ‚ÄòName like &quot;*admin*&quot;‚Äô | select Name</strong></blockquote><blockquote id="a05fdb63-dd94-4833-b59b-b90e33dda9e6" class=""><strong>Get-ADGroup -Filter * | where {$_.Name -like &#x27;*</strong><strong><em>admin*</em></strong><strong>&#x27;} | select Name</strong></blockquote><p id="2ddc247f-fc43-4f67-951e-945efd1949b6" class="">
</p><h3 id="4ad72a23-3303-4f67-8247-1a316b424fd5" class="block-color-red"><span style="border-bottom:0.05em solid"><strong>Group Members</strong></span></h3><p id="923da0a8-5864-4f5d-9dbf-e699a75c6f4d" class=""><strong><code>The comamnd retuns all member of the DNSAdmins group</code></strong></p><blockquote id="0e86aa5a-800d-4cfc-87f1-7aab7d9c4423" class=""><strong>Get-ADGroupMember -Identity &quot;DNSAdmins&quot; -Recursive</strong></blockquote><blockquote id="2e5b3503-9a74-43bc-83e6-d2005355c6de" class=""><strong>Get-ADGroupMember -Identity &quot;DNSAdmins&quot; -Recursive</strong></blockquote><ul id="fe5e9a84-5d8d-43bc-8113-116d00aa719c" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><code><strong>Recrusive is a good parameter to search nested groups</strong></code></mark></li></ul><p id="ed115e0d-79a4-476c-9933-a0b518fea934" class=""><code><strong>The command returns all member of the domain admins group</strong></code></p><blockquote id="8f361840-7cd6-46a6-8a9e-78319cfdcac7" class=""><strong>Get-ADGroupMember -Identity &quot;Domain Admins&quot; -Recursive</strong></blockquote><p id="88e230be-554c-4ea3-9003-3cd8d4da9b4b" class=""><code><strong>The command searches for the groups that belongs to a user/member i.e. Ryan</strong></code></p><blockquote id="cb2384a3-9efb-48c9-8cf6-1edadb503e18" class=""><strong>Get-ADPrincipalGroupMembership  -Identity  Ryan</strong></blockquote><ul id="8f791f4d-9a91-4bf4-9867-8066694b060e" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><code><strong>Identity name like Ryan without quotes</strong></code></mark></li></ul><p id="eb12aa23-5689-4bde-9c77-b1418ee5d6e8" class=""><code><strong>Enumerate the Enterprise Administrators using the Active Directory Module</strong></code></p><blockquote id="6010bd12-482e-48dc-a2ce-4add3f22d1a7" class=""><strong>Get-ADGroupMember -Identity &#x27;Enterprise Admins&#x27; -Server [Forest Name]</strong></blockquote><ul id="2cb13d30-dcef-410b-8c5b-abfb12ae90ec" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><code><strong>Get the forest name by running </strong></code></mark><mark class="highlight-red"><code><strong>Get-AdDomain | select forest</strong></code></mark></li></ul><p id="84ee084f-e583-4a6b-9a3d-b4a7a89e19d8" class="">
</p><h1 id="c7bed137-dfc7-4cd4-bfd8-427eb03a9361" class="block-color-purple">Enumerating Organizational Units [OU]</h1><p id="61c2320a-c628-41f7-8531-a85264914046" class=""><mark class="highlight-red"><strong>The command returns all of the available organizational units</strong></mark></p><blockquote id="a6c0aeeb-6ff6-44dc-8c3d-98099326977e" class=""><strong>Get-ADOrganizationalUnit -Filter * -Properties *</strong></blockquote><p id="b5b59b07-42d3-4213-8873-244499a42d2e" class="">
</p><p id="bcdae995-3918-4a00-ae36-8943c18758ce" class="">
</p><hr id="ed14142c-49f9-4484-b547-ba6803288a5d"/><h3 id="9b3d589d-288b-4983-83b2-47db6e5643fd" class="">üîî Follow R3d Buck3t Publication on Medium - <a href="https://medium.com/r3d-buck3t">https://medium.com/r3d-buck3t</a></h3><h1 id="9e2826ca-4509-4db1-8847-ad547422c420" class="">üìö$_Resources</h1><figure id="97f87310-692d-49ec-aa87-c1f79664f8fc"><a href="https://medium.com/r3d-buck3t/domain-enumeration-with-active-directory-powershell-module-7ce4fcfe91d3" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">Domain Enumeration with Active Directory PowerShell Module</div><div class="bookmark-description">Post-exploitation enumeration of windows domain controller with PowerShell PowerShell Active Directory module is a group of command-lets (cmdlet) domain admins use to query and manage objects in the Active directory. It is a part of the utilities and modules in Remote Server Administration Tools (RSAT).</div></div><div class="bookmark-href"><img src="https://miro.medium.com/1*m-R_BkNf1Qjr1YbyOIJY2w.png" class="icon bookmark-icon"/>https://medium.com/r3d-buck3t/domain-enumeration-with-active-directory-powershell-module-7ce4fcfe91d3</div></div><img src="https://miro.medium.com/max/1200/1*k00JUYbnxdhzvyHxDYlvjQ.jpeg" class="bookmark-image"/></a></figure><figure id="8826fbc9-7c3f-4aec-af28-d4942ef631b6"><a href="https://janikvonrotz.ch/2015/09/09/deploy-powershell-activedirectory-module-without-installing-the-remote-server-tools/" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">Deploy PowerShell ActiveDirectory Module without installing the remote server tools</div><div class="bookmark-description">2 min read Make use of the PowerShell ActiveDirectory module always required to install the Remote Server Administration Tools. That sucks! We want it as simple as executing a script. Let&#x27;s build a PowerShell script that adds the ActiveDirectory Powershell module on any computer.</div></div><div class="bookmark-href"><img src="https://janikvonrotz.ch/images/logo.png" class="icon bookmark-icon"/>https://janikvonrotz.ch/2015/09/09/deploy-powershell-activedirectory-module-without-installing-the-remote-server-tools/</div></div><img src="https://janikvonrotz.ch/wp-content/uploads/2015/06/PowerShell-logo-e1433137513315.png" class="bookmark-image"/></a></figure><figure id="2ba34c0b-8381-423b-9d1d-a1376bafba78"><a href="https://adamtheautomator.com/powershell-import-active-directory/" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">How to Install and Import the PowerShell Active Directory Module</div><div class="bookmark-description">A prerequisite for every PowerShell Active Directory (AD) task is to install the Active Directory module. This popular module allows administrators to query and make changes to Active Directory with PowerShell. Discover, report and prevent insecure Active Directory account passwords in your environment with Specops&#x27; completely free Password Auditor Pro.</div></div><div class="bookmark-href"><img src="https://adamtheautomator.com/wp-content/themes/adam-the-automator/assets/images/favicon.ico" class="icon bookmark-icon"/>https://adamtheautomator.com/powershell-import-active-directory/</div></div><img src="https://adamtheautomator.com/wp-content/uploads/2019/08/active-directory-module.png" class="bookmark-image"/></a></figure><figure id="3cb184de-8671-4d7e-a004-b8461a887b13"><a href="https://docs.microsoft.com/en-us/powershell/module/activedirectory/?view=windowsserver2019-ps" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">ActiveDirectory Module</div><div class="bookmark-description">The Active Directory module for Windows PowerShell is a PowerShell module that consolidates a group of cmdlets. You can use these cmdlets to manage your Active Directory domains, Active Directory Lightweight Directory Services (AD LDS) configuration sets, and Active Directory Database Mounting Tool instances in a single, self-contained package.</div></div><div class="bookmark-href"><img src="https://docs.microsoft.com/favicon.ico" class="icon bookmark-icon"/>https://docs.microsoft.com/en-us/powershell/module/activedirectory/?view=windowsserver2019-ps</div></div><img src="https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png" class="bookmark-image"/></a></figure><figure id="3d491b45-8dd0-4d31-81f7-47454774b40b"><a href="https://www.tutorialspoint.com/how-to-install-the-powershell-active-directory-module" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">How to install the PowerShell Active Directory module?</div><div class="bookmark-description">To install the active directory module using PowerShell, you need Remote Server Administrator Tools (RSAT) on the server. It should be available in the Roles and Features section of the windows server operating system as shown below and you can enable it from the GUI as well.</div></div><div class="bookmark-href"><img src="https://www.tutorialspoint.com/favicon.ico" class="icon bookmark-icon"/>https://www.tutorialspoint.com/how-to-install-the-powershell-active-directory-module</div></div><img src="https://www.tutorialspoint.com/assets/questions/media/45015/active_directory.jpg" class="bookmark-image"/></a></figure><figure id="e7381a38-3a2c-4393-8066-985349704ad8"><a href="https://github.com/samratashok/ADModule/blob/master/ActiveDirectory/ActiveDirectory.Format.ps1xml" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">ADModule/ActiveDirectory.Format.ps1xml at master ¬∑ samratashok/ADModule</div><div class="bookmark-description">This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters You can&#x27;t perform that action at this time. You signed in with another tab or window.</div></div><div class="bookmark-href"><img src="https://github.com/favicon.ico" class="icon bookmark-icon"/>https://github.com/samratashok/ADModule/blob/master/ActiveDirectory/ActiveDirectory.Format.ps1xml</div></div><img src="https://opengraph.githubassets.com/b0cbc598737263975df23dbc0d7cafbf90eff69a6e05b9a4a633b43b51e98d27/samratashok/ADModule" class="bookmark-image"/></a></figure><figure id="73ba8833-ec03-48b2-ac71-5e745c90d831"><a href="https://github.com/samratashok/ADModule/blob/master/ActiveDirectory/ActiveDirectory.psd1" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">ADModule/ActiveDirectory.psd1 at master ¬∑ samratashok/ADModule</div><div class="bookmark-description">This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters You can&#x27;t perform that action at this time. You signed in with another tab or window.</div></div><div class="bookmark-href"><img src="https://github.com/favicon.ico" class="icon bookmark-icon"/>https://github.com/samratashok/ADModule/blob/master/ActiveDirectory/ActiveDirectory.psd1</div></div><img src="https://opengraph.githubassets.com/b0cbc598737263975df23dbc0d7cafbf90eff69a6e05b9a4a633b43b51e98d27/samratashok/ADModule" class="bookmark-image"/></a></figure><p id="339b4488-4340-4829-b63f-5b5e32126ac1" class="">
</p></div></article></body></html>
